var SocwallUploaderClass=Class.extend({initialize:function(options){this.options=$.extend(true,{},options||{});var self=this;$(document).ready(function(){self.fileDropZoneSetup();});},fileDropZoneSetup:function(){var self=this;var ajaxData={'view':'wallpaper/forms/upload','formComponentId':'wallpaperImage','controller':'forms/Forms','function':'wallpaperUploadFile','viewData':{}};this.fileDropZone=new FileDropZone($('.fileDropZone'),'/api/forms/processFormComponentFile/',ajaxData,{'onUploadStartContext':self,'onUploadStart':'fileDropZoneUploadStart','onUploadProgressContext':self,'onUploadProgress':'fileDropZoneUploadProgress','onUploadCompleteContext':self,'onUploadComplete':'fileDropZoneUploadComplete'});},fileDropZoneUploadStart:function(fileUploadHandler){this.fileDropZone.getFileList($('.fileDropZoneFiles'));},fileDropZoneUploadProgress:function(fileUploadHandler){this.fileDropZone.getFileList($('.fileDropZoneFiles'));},fileDropZoneUploadComplete:function(fileUploadHandler,response){this.fileDropZone.getFileList($('.fileDropZoneFiles'));response=Json.decode(response);if(response.status=='success'){var wallpaperImage;if(wallpaperUploadObject.formPages['wallpaperUpload-page1'].formSections['wallpapers'].select('wallpaperImageLocation').getValue()==''){wallpaperImage=wallpaperUploadObject.formPages['wallpaperUpload-page1'].formSections['wallpapers'].select('wallpaperImage');}
else{wallpaperImage=wallpaperUploadObject.formPages['wallpaperUpload-page1'].formSections['wallpapers'].addSectionInstance().select('wallpaperImage');}
wallpaperImage.component.find('input.file').addClass('ajaxHandled');var formSection=wallpaperImage.parentFormSection;formSection.section.find('.wallpaperUploadPreview').empty().append('<img src="'+response.imagePreviewUrl+'" alt="" />');formSection.select('wallpaperTitle').setValue(response.wallpaperTitle);if(response.wallpaperTags){formSection.select('wallpaperTags').setValue(response.wallpaperTags);}
formSection.select('wallpaperImageLocation').setValue(response.imageName);}}});var SocwallUploader=new SocwallUploaderClass();