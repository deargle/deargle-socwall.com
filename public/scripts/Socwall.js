var SocwallClass=Class.extend({initialize:function(options){this.options=$.extend(true,{},options||{});var self=this;$(document).ready(function(){self.setupSearchListeners();self.createBrowseTip();})},setupSearchListeners:function(){var self=this;$('.search input').keypress(function(event){var code=(event.keyCode?event.keyCode:event.which);if(code==13){self.search($(this).val());}});},search:function(string){document.location='/wallpapers/search:'+string+'/';},getDialog:function(dialog,data){if(data&&data.loginRequired&&User.loggedIn){}
else{}},showDialog:function(message,options){options=$.extend(true,{'class':'formDialog','modalOverlayClass':'formModalOverlay','content':message,'onAfterShow':function(){}},options||{});this.dialog=new Dialog(options);},showUploadTip:function(target){if(!this.uploadTip){this.uploadTip=new Tip(target,{'targetCorner':'bottomLeft','offset':{'left':0,'top':'6px'},'ajax':{'url':'/api/web/getUploadTip/','data':{'outputType':'string'},'onSuccess':function(){$('#wallpaperTitle').focus();}}});this.uploadTip.show();}
else{this.uploadTip.show();}},showContactTip:function(target){if(!this.contactTip){this.contactTip=new Tip(target,{'targetCorner':'bottomLeft','offset':{'left':0,'top':'6px'},'ajax':{'url':'/api/web/getContactTip/','data':{'outputType':'string'},'onSuccess':function(){$('#contactName').focus();}}});this.contactTip.show();}
else{this.contactTip.show();$('#contactName').focus();}},createBrowseTip:function(){this.browseTip=new Tip($('#browseButton'),{'showOn':'click','hideOn':'hover','class':'browseTip','targetCorner':'bottomLeft','offset':{'left':0,'top':'6px'},'content':$('#browseList')});},showNewsTip:function(target){this.newsTip=new Tip(target,{'targetCorner':'bottomLeft','offset':{'left':0,'top':'6px'},'ajax':{'url':'/api/web/getNewsTip/','data':{'outputType':'string'},'onSuccess':function(){}}});},showDeleteWallpaperTip:function(target,wallpaperId){var deleteTip=new Tip(target,{'class':'deleteWallpaperTip deleteWallpaperTip'+wallpaperId,'targetCorner':'bottomLeft','destroyOnHide':true,'ajax':{'url':'/api/web/getDeleteWallpaperTip/','data':{'wallpaperId':wallpaperId,'outputType':'string'}}});deleteTip.show();},showFlagWallpaperTip:function(target,wallpaperId){var flagTip=new Tip(target,{'class':'flagWallpaperTip flagWallpaperTip'+wallpaperId,'targetCorner':'bottomLeft','destroyOnHide':true,'ajax':{'url':'/api/web/getFlagWallpaperTip/','data':{'wallpaperId':wallpaperId,'outputType':'string'}}});flagTip.show();},showSignInTip:function(target){var self=this;if(!this.signInTip){this.signInTip=new Tip(target,{'offset':{'left':0,'top':'6px'},'ajax':{'url':'/api/web/getSignInTip/','data':{'outputType':'string'},'onSuccess':function(){self.handleSignInTip(target);}},'class':'signInTip'});this.signInTip.show();}
else{this.signInTip.setTarget(target);self.handleSignInTip(target);}},handleSignInTip:function(target){if($(target).parents('.vote').length!=0){this.signInTip.tipWrapper.find('h2').text('Sign In to Vote');}
else if($(target).parents('.favorite').length!=0){this.signInTip.tipWrapper.find('h2').text('Sign In to Favorite');}
else if($(target).parents('#rightNavigation').length!=0){this.signInTip.tipWrapper.find('h2').text('Sign In');}
$('#signInIdentifier').focus();},showLoginDialog:function(){User.showLoginDialog({ajax:{onSuccess:function(){}}});},showRegisterDialog:function(options){var ajax=null;if(options&&options.ajax){ajax=options.ajax;delete options.ajax;}
options=$.extend(true,{'class':'formDialog','modalOverlayClass':'formModalOverlay','header':'',ajax:{'url':'/api/web/getRegisterDialog/outputType:raw/','onSuccess':function(){if(ajax&&ajax.onSuccess){ajax.onSuccess();}
$('#registerUsername').focus();}}},options||{});this.registerDialog=new Dialog(options);},rate:function(wallpaperId,direction,element){var self=this;if(!User.loggedIn){this.showSignInTip(element);return false;}
var processingLi=element.parent().parent().parent().find('.processing');processingLi.fadeIn();var currentElementOpacity;var oppositeElementOpacity;if(direction=='up'){if(element.parent().is('.active')){element.parent().removeClass('active');currentElementOpacity=.8;oppositeElementOpacity=.8;}
else{element.parent().addClass('active');currentElementOpacity=1;oppositeElementOpacity=.25;}}
else if(direction=='down'){if(element.parent().is('.active')){element.parent().removeClass('active');currentElementOpacity=.8;oppositeElementOpacity=.8;}
else{element.parent().addClass('active');currentElementOpacity=1;oppositeElementOpacity=.25;}}
element.parent().siblings('.vote').removeClass('active');element.animate({opacity:currentElementOpacity});element.parent().siblings('.vote').find('a').animate({opacity:oppositeElementOpacity});this.rateAjax=$.ajax({url:'/api/socwall/rate/',type:'POST',dataType:'json',data:{wallpaperId:wallpaperId,direction:direction},success:function(data){processingLi.fadeOut();if(data.wallpaperRating>0){element.parent().siblings('.rating').text('+'+data.wallpaperRating)}
else if(data.wallpaperRating<=0){element.parent().siblings('.rating').text(data.wallpaperRating)}}});return true;},toggleFavorite:function(wallpaperId,element){var self=this;if(!User.loggedIn){this.showSignInTip(element);return false;}
var processingLi=element.parent().parent().parent().find('.processing');processingLi.fadeIn();if(element.parent().is('.active')){element.parent().removeClass('active');}
else{element.parent().addClass('active');}
this.favoriteAjax=$.ajax({url:'/api/socwall/toggleFavorite/',type:'POST',dataType:'json',data:{wallpaperId:wallpaperId},success:function(data){processingLi.fadeOut();element.parent().removeClass('active').removeClass('inactive').addClass(data.wallpaperFavoriteStatus);}});return true;}});var Socwall=new SocwallClass();